
<head>
<script type="text/javascript"> 
let bgc = "white";
function display_c(){
var refresh=1000; // Refresh rate in milli seconds
mytime=setTimeout('display_ct()',refresh)


}

//var addSec = 50;
	

	
	
function display_ct() {
	var bodyLabel = '';
	var curClass = document.getElementsByClassName('time');
	var periodsGradeA = document.getElementsByClassName('col1 period');
	var startTimesGradeA = document.getElementsByClassName('col2 time');
	var endTimesGradeA = document.getElementsByClassName('col3 time');
	var periodsGradeB = document.getElementsByClassName('col4 period');
	var startTimesGradeB = document.getElementsByClassName('col5 time');
	var endTimesGradeB = document.getElementsByClassName('col6 time');
	var periodsGradeC = document.getElementsByClassName('col7 period');
	var startTimesGradeC = document.getElementsByClassName('col8 time');
	var endTimesGradeC = document.getElementsByClassName('col9 time');
	var periodsGradeD = document.getElementsByClassName('col10 period');
	var startTimesGradeD = document.getElementsByClassName('col11 time');
	var endTimesGradeD = document.getElementsByClassName('col12 time');
	
	//Lunch Vars
	var periodsGradeALunch = document.getElementsByClassName('lunch col1');
	var startTimesGradeALunch = document.getElementsByClassName('lunch col2');
	var endTimesGradeALunch = document.getElementsByClassName('lunch col3');
	var periodsGradeBLunch = document.getElementsByClassName('lunch col4');
	var startTimesGradeBLunch = document.getElementsByClassName('lunch col5');
	var endTimesGradeBLunch = document.getElementsByClassName('lunch col6');
	var periodsGradeCLunch = document.getElementsByClassName('lunch col7');
	var startTimesGradeCLunch = document.getElementsByClassName('lunch col8');
	var endTimesGradeCLunch = document.getElementsByClassName('lunch col9');
	var periodsGradeDLunch = document.getElementsByClassName('lunch col10');
	var startTimesGradeDLunch = document.getElementsByClassName('lunch col11');
	var endTimesGradeDLunch = document.getElementsByClassName('lunch col12');
	
	
	var tableTimeHoursStart;
	var tableTimeMinsStart;
	var tableTimeHoursEnd;
	var tableTimeMinsEnd;
	var tableTimeHoursStartLunch;
	var tableTimeMinsStartLunch;
	var tableTimeHoursEndLunch;
	var tableTimeMinsEndLunch;
	var curTimeHours;
	var curTimeMins;
	var curTimeSec = 0;
	var curTimeMilli = 0;
	var tableTimeStart = new Date();
	var tableTimeEnd = new Date();
	var tableTimeStartLunch = new Date();
	var tableTimeEndLunch = new Date();
	var bgCount = 0;
	let schoolSelect = '';
	let curSchool = '';	
	let curSchoolDir = '';
	let scheduleSelect = '';
	let curSchedule = '';
	let curFileName = '';
	let noSchoolSelected = false;
	let noScheduleSelected = false;
var x = new Date();
//x.setTime(x.getTime() /*- (6 * 60 * 60 * 1000) */ - (464 * 60 * 1000) - (30 * 1000));

//x.setHours(9,47,addSec,0);
//addSec++;
var fiveMinsBefore = new Date();
var fiveMinsAfter = new Date();
var fiveAfterCur = new Date();
var curMins;

var fiveMinsBeforeLunch = new Date();
var fiveMinsAfterLunch = new Date();

var tableTime = new Date();
document.getElementById('ct').innerHTML = x.toLocaleTimeString(/*'en-US-u-hc-h12', { hour: 'numeric', minute: '2-digit' }*/);
document.getElementById('date').innerHTML = x.toLocaleDateString('en-US', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'});
curMins = ct.innerHTML.split(':')[1].split(':')[0];	


	var tableTime = new Date();
		schoolSelect = document.getElementById('schools');
		curSchool = schoolSelect.value;

	if (document.getElementById('table')){
	
		if (document.getElementById('gradeAHeader')){
			gradeAHeader.innerHTML = document.getElementsByClassName('header col2')[0].innerHTML;
		}
		if (document.getElementById('gradeBHeader')){
			gradeBHeader.innerHTML = document.getElementsByClassName('header col5')[0].innerHTML;
		}
		if (document.getElementById('gradeCHeader')){
			gradeCHeader.innerHTML = document.getElementsByClassName('header col8')[0].innerHTML;
		}
		if (document.getElementById('gradeDHeader')){
			gradeDHeader.innerHTML = document.getElementsByClassName('header col11')[0].innerHTML;
		}

	
		


			
		
		if (document.getElementById('gradeAMarquee')){
			displayPage(periodsGradeA, startTimesGradeA, endTimesGradeA, periodsGradeALunch, startTimesGradeALunch, endTimesGradeALunch, gradeAMarquee);
		}
		if (document.getElementById('gradeBMarquee')){
			displayPage(periodsGradeB, startTimesGradeB, endTimesGradeB, periodsGradeBLunch, startTimesGradeBLunch, endTimesGradeBLunch, gradeBMarquee);
		}
		if (document.getElementById('gradeCMarquee')){
			displayPage(periodsGradeC, startTimesGradeC, endTimesGradeC, periodsGradeCLunch, startTimesGradeCLunch, endTimesGradeCLunch, gradeCMarquee);
		}
		if (document.getElementById('gradeDMarquee')){
			displayPage(periodsGradeD, startTimesGradeD, endTimesGradeD, periodsGradeDLunch, startTimesGradeDLunch, endTimesGradeDLunch, gradeDMarquee);
		}
		
	function displayPage(classPeriods, classStartTimes, classEndTimes, lunchPeriods, lunchStartTimes, lunchEndTimes, marquee){
		bgCount = 0;
		for (k = 0; k < classPeriods.length; k++) {
			if (classStartTimes[k] != null && classEndTimes[k] != null) {
			//convert 6th grade start times from table to JS DateTimes
			tableTimeHoursStart = classStartTimes[k].innerHTML.split(':')[0];
			tableTimeHoursStart = parseInt(tableTimeHoursStart);
			if(tableTimeHoursStart < 5) {tableTimeHoursStart += 12;}
			tableTimeMinsStart = classStartTimes[k].innerHTML.split(':')[1].split(' ')[0];
			tableTimeStart.setHours(tableTimeHoursStart,tableTimeMinsStart,0,0);
			
			//convert 6th grade end times from table to JS DateTimes
			tableTimeHoursEnd = classEndTimes[k].innerHTML.split(':')[0];
			tableTimeHoursEnd = parseInt(tableTimeHoursEnd);
			if(tableTimeHoursEnd < 5) {tableTimeHoursEnd += 12;}
			tableTimeMinsEnd = classEndTimes[k].innerHTML.split(':')[1].split(' ')[0];
			tableTimeEnd.setHours(tableTimeHoursEnd,tableTimeMinsEnd,0,0);
			
				
			fiveMinsBefore.setTime(tableTimeEnd.getTime() - (5 * 60 * 1000));
			fiveMinsAfter.setTime(tableTimeEnd.getTime() + (5 * 60 * 1000));
			fiveAfterCur.setTime(x.getTime() + (5 * 60 * 1000));
				
				if (tableTimeStart < fiveAfterCur && x < tableTimeStart){
					classPeriods[k].style.background = "yellow";
					classPeriods[k].style.color = "black";
					classStartTimes[k].style.background = "yellow";
					classStartTimes[k].style.color = "black";
					classEndTimes[k].style.background = "yellow";
					classEndTimes[k].style.color = "black";
					marquee.innerHTML = "Changing Classes<br />Heading to <b>" + classPeriods[k].innerHTML + "</b>";
					bgCount = 1;
				}
				
				else if (tableTimeStart <= x && fiveMinsBefore > x) {
				//changing 6th grade period to blue
					classPeriods[k].style.background = bgc;
					classPeriods[k].style.color = "white";
					classStartTimes[k].style.background = bgc;
					classStartTimes[k].style.color = "white";
					classEndTimes[k].style.background = bgc;
					classEndTimes[k].style.color = "white";
					marquee.innerHTML = "<b>" + classPeriods[k].innerHTML + "</b><br />" + classStartTimes[k].innerHTML + " - " + classEndTimes[k].innerHTML;
					bgCount = 2;
				} 
				
				else if (x >= fiveMinsBefore && x < tableTimeEnd) {
					classPeriods[k].style.background = "yellow";
					classPeriods[k].style.color = "black";															
					classStartTimes[k].style.background = "yellow";															
					classStartTimes[k].style.color = "black";															
					classEndTimes[k].style.background = "yellow";															
					classEndTimes[k].style.color = "black";	
					var minsLeft = tableTimeMinsEnd - curMins;
					if (minsLeft > 1){
						marquee.innerHTML = "<b>" + classPeriods[k].innerHTML + "</b><br />" + minsLeft + " minutes left";
					} else if (minsLeft < 1) {
							minsLeft += 60;
								if (minsLeft > 1){
												marquee.innerHTML = "<b>" + classPeriods[k].innerHTML + "</b><br />" + minsLeft + " minutes left";
												} else {marquee.innerHTML = "<b>" + classPeriods[k].innerHTML + "</b><br />" + minsLeft + " minute left";
														}							
						} else if (minsLeft == 1) {
								marquee.innerHTML = "<b>" + classPeriods[k].innerHTML + "</b><br />" + minsLeft + " minute left";
								}
					bgCount = 3;
					
				} else if (k == classPeriods.length - 1 && x >= tableTimeEnd){
					classPeriods[k].style.background = "white";
					classPeriods[k].style.color = "black";
					classStartTimes[k].style.background = "white";
					classStartTimes[k].style.color = "black";
					classEndTimes[k].style.background = "white";
					classEndTimes[k].style.color = "black";
					marquee.innerHTML = "School's Out";
				} else {
					classPeriods[k].style.background = "white";
					classPeriods[k].style.color = "black";
					classStartTimes[k].style.background = "white";
					classStartTimes[k].style.color = "black";
					classEndTimes[k].style.background = "white";
					classEndTimes[k].style.color = "black";
				}
				//periodsP.innerHTML = bgCount;
				switch (bgCount) {
					//out of school and default
					case 0: 
							marquee.style.background = "white";
							marquee.style.color = "black";
							break;
							
					//changing classes
					case 1: 
							marquee.style.background = "yellow";
							marquee.style.color = "black";
							break;
							
					//normal ops
					case 2: 
							marquee.style.background = bgc;
							marquee.style.color = "white";
							break;
					//5 mins left do not call
					case 3:
							marquee.style.background = "yellow";
							marquee.style.color = "black";
							break;
							
				}		
					
			}	
		}	
		
		///////////////////////A Grade Lunch//////////////////////
		for (k = 0; k < lunchPeriods.length; k++) {
			if (lunchStartTimes[k] != null && lunchEndTimes[k] != null) {
			//convert 6th grade start times from table to JS DateTimes
			tableTimeHoursStartLunch = lunchStartTimes[k].innerHTML.split(':')[0];
			tableTimeHoursStartLunch = parseInt(tableTimeHoursStartLunch);
			if(tableTimeHoursStartLunch < 5) {tableTimeHoursStartLunch += 12;}
			tableTimeMinsStartLunch = lunchStartTimes[k].innerHTML.split(':')[1].split(' ')[0];
			tableTimeStartLunch.setHours(tableTimeHoursStartLunch,tableTimeMinsStartLunch,0,0);
			
			//convert 6th grade end times from table to JS DateTimes
			tableTimeHoursEndLunch = lunchEndTimes[k].innerHTML.split(':')[0];
			tableTimeHoursEndLunch = parseInt(tableTimeHoursEndLunch);
			if(tableTimeHoursEndLunch < 5) {tableTimeHoursEndLunch += 12;}
			tableTimeMinsEndLunch = lunchEndTimes[k].innerHTML.split(':')[1].split(' ')[0];
			tableTimeEndLunch.setHours(tableTimeHoursEndLunch,tableTimeMinsEndLunch,0,0);
			
				
			fiveMinsBeforeLunch.setTime(tableTimeEndLunch.getTime() - (5 * 60 * 1000));
			fiveMinsAfterLunch.setTime(tableTimeEndLunch.getTime() + (5 * 60 * 1000));
			fiveAfterCur.setTime(x.getTime() + (5 * 60 * 1000));
				
				if (tableTimeStartLunch < fiveAfterCur && x < tableTimeStartLunch){
					lunchPeriods[k].style.background = "red";
					lunchPeriods[k].style.color = "white";
					lunchStartTimes[k].style.background = "red";
					lunchStartTimes[k].style.color = "white";
					lunchEndTimes[k].style.background = "red";
					lunchEndTimes[k].style.color = "white";
				}
				
				else if (tableTimeStartLunch <= x && fiveMinsBeforeLunch > x) {
					lunchPeriods[k].style.background = "red";
					lunchPeriods[k].style.color = "white";
					lunchStartTimes[k].style.background = "red";
					lunchStartTimes[k].style.color = "white";
					lunchEndTimes[k].style.background = "red";
					lunchEndTimes[k].style.color = "white";
				} 
				
				else if (x >= fiveMinsBeforeLunch && x < fiveMinsAfterLunch) {
					lunchPeriods[k].style.background = "red";
					lunchPeriods[k].style.color = "white";
					lunchStartTimes[k].style.background = "red";
					lunchStartTimes[k].style.color = "white";
					lunchEndTimes[k].style.background = "red";
					lunchEndTimes[k].style.color = "white";																				
				} else {
					lunchPeriods[k].style.background = "white";
					lunchPeriods[k].style.color = "black";
					lunchStartTimes[k].style.background = "white";
					lunchStartTimes[k].style.color = "black";
					lunchEndTimes[k].style.background = "white";
					lunchEndTimes[k].style.color = "black";
				}		
					
			}	
		}
	}
		
						
		}


display_c();
 }



</script>
</head>

<body onload=display_ct();>
	<div id='ctContainer'>
		<h1 id='bodyLabelContainer'></h1>
		<h1 id='ct' ></h1>
		<p id='date'></p>
	</div>


<script type="text/javascript">
	


    function Upload() {

	noSchoolSelected = false;
	noScheduleSelected = false;	
	document.getElementById('selectWarning').innerHTML = '';
	schoolSelect = document.getElementById('schools');
	curSchoolDir = schoolSelect.value;
	scheduleSelect = document.getElementById('schedules');
	curSchedule = scheduleSelect.value;	    
	var scheduleData = '';
		var xmlhttp = new XMLHttpRequest();
		xmlhttp.onreadystatechange = function(){
			if(xmlhttp.status == 200 && xmlhttp.readyState == 4){
				scheduleData = xmlhttp.responseText;
				fillTables(scheduleData);
				  } else if (xmlhttp.status == 404) {
					document.getElementById('marquee').innerHTML = 'There is no schedule file for the selected schedule. Please contact your building\'s IT Support Technician or <a href="https://techlink.cmcss.net/Support/WorkOrders/Create">Submit a Work Order</a>.';
		    			document.getElementById('dvLunches').innerHTML = '';
		   			document.getElementById('dvCSVLabel').innerHTML = '';
		    			document.getElementById('dvCSV').innerHTML = '';
				  }
			};
   
	   

	    		document.getElementById('ctContainer').style.backgroundImage = "none";
	    		switch (curSchoolDir){
				case 'default':
					document.getElementById('ctContainer').style.backgroundImage = "none";
					noSchoolSelected = true;
					break;
				case 'CHS':
					bgc = "#400080";
					break;	
				case 'KHS':
					bgc = "#a69540";
					break;
				case 'KiMS':
					bgc = "#ED8B2E";
					break;
				case 'KMS':
					bgc = "#a69540";
					break;
				case 'MCHS':
					bgc = "#a01517";
					break;
				case 'MCMS':
					bgc = "#a01517";
					break;
				case 'NEHS':
					bgc = "#131B42";
					break;
				case 'NEMS':
					bgc = "#131B42";
					break;
				case 'NPMS':
					bgc = "#0067b4";
					break;
				case 'NWHS':
					bgc = "#143E28";
					break;
				case 'RMS':
					bgc = "#1B3C9D";
					break;
				case 'RSHS':
					bgc = "#B30000";
					break;
				case 'RSMS':
					bgc = "#B30000";
					break;
				case 'WCHS':
					bgc = "#5D1932";
					break;
				case 'WCMS':
					bgc = "#5D1932";
					break;
				}
	   
    function urlExists(url) {
        var http = new XMLHttpRequest();
        http.open('HEAD', url , false);
        http.send();
        if (http.status != 404)
            return true;
        else
            return false;
    }
	   
	    
	    			let imgURL = "/img/"+curSchoolDir+".jpg";
	    			if (urlExists(imgURL)){
	    			document.getElementById('ctContainer').style.backgroundImage = "url("+imgURL+")";
				} else {
					document.getElementById('ctContainer').style.backgroundImage = "none";
				}
	    			bodyLabel = "";
	    		switch (curSchedule){
				case 'default':
					curFileName = "";
					noScheduleSelected = true;
					bodyLabel = "";
					break;
				case 'normal':
					curFileName = "normal.csv";
					bodyLabel = "Normal Day";
					break;
				case 'half-day':
					curFileName = "half-day.csv";
					bodyLabel = "Half Day";
					break;
				case '1-hour-delay':
					curFileName = "1-hour-delay.csv";
					bodyLabel = "1 Hour Delay";
					break;
				case '2-hour-delay':
					curFileName = "2-hour-delay.csv";
					bodyLabel = "2 Hour Delay";
					break;
				case 'am-pep-rally':
					curFileName = "am-pep-rally.csv";
					bodyLabel = "A.M. Pep Rally";
					break;
				case 'pm-pep-rally':
					curFileName = "pm-pep-rally.csv";
					bodyLabel = "P.M. Pep Rally";
					break;
				case 'request-new-sched':
					curFileName = "request-new";
					document.getElementById('marquee').innerHTML = 'To request a new or updated schedule, contact your building\'s IT Support Technician or <a href="https://techlink.cmcss.net/Support/WorkOrders/Create">Submit a Work Order</a>.';
		    			document.getElementById('dvLunches').innerHTML = '';
		   			document.getElementById('dvCSVLabel').innerHTML = '';
		    			document.getElementById('dvCSV').innerHTML = '';
					document.getElementById('selectWarning').innerHTML = '';
					bodyLabel = "Request new or updated schedule";
					break;
				case 'TCAP-4-17-23':
					curFileName = "TCAP-4-17-23.csv";
					bodyLabel = "TCAP Schedule"
					break;
				case 'TCAP-4-18-23':
					curFileName = "TCAP-4-18-23.csv";
					bodyLabel = "TCAP Schedule"
					break;
				case 'TCAP-4-20-23':
					curFileName = "TCAP-4-20-23.csv";
					bodyLabel = "TCAP Schedule"
					break;
			}
	    let warningTrigger = false;
	    if (curFileName == "request-new") {
		    document.getElementById('marquee').innerHTML = 'To request a new or updated schedule, contact your building\'s IT Support Technician or <a href="https://techlink.cmcss.net/Support/WorkOrders/Create">Submit a Work Order</a>.';
		    document.getElementById('dvLunches').innerHTML = '';
		    document.getElementById('dvCSVLabel').innerHTML = '';
		    document.getElementById('dvCSV').innerHTML = '';
		    document.getElementById('selectWarning').innerHTML = '';
	    } else if (noSchoolSelected == false && noScheduleSelected == false){
		   	document.getElementById('schoolsLabel').innerHTML = "Choose your school: ";
		    	document.getElementById('selectWarning').innerHTML = '';
		    	xmlhttp.open("GET","/"+curSchoolDir+"/"+curFileName,true);
		    	xmlhttp.send();
		} else {
			warningTrigger = true;
		    document.getElementById('marquee').innerHTML = '';
		    document.getElementById('dvLunches').innerHTML = '';
		    document.getElementById('dvCSVLabel').innerHTML = '';
		    document.getElementById('dvCSV').innerHTML = '';
		    document.getElementById('schoolsLabel').innerHTML = "Choose your school: ";
		    let redTextSpan = document.createElement('span');
		    redTextSpan.innerHTML = "You must select a school and a schedule!";
		    document.getElementById('bodyLabelContainer').style.color = "red";
		    document.getElementById('bodyLabelContainer').innerHTML = redTextSpan.innerHTML;
		}
	    	
	    if (warningTrigger == false){
		document.getElementById('bodyLabelContainer').style.color = "black";
	    	document.getElementById('bodyLabelContainer').innerHTML = bodyLabel;
	    }
					    
     }
	 function fillTables(data) {
		    	let lunchTrigger = 0;
			let cell = '';
			var table = document.createElement("table");
			table.id = "table";
			var tableLunches = document.createElement("table");
			tableLunches.id = "tableLunches";	
                    var rows = data.split("\n");
	    		
                    for (let i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
						
                        if (cells.length > 1) {
							
							if (lunchTrigger == 0) {
								var row = table.insertRow(-1);
							} else if (lunchTrigger == 1) {
														//document.getElementById('periodsP').innerHTML = "inside row creation";
															var row = tableLunches.insertRow(-1);
															}
															
                            for (let j = 0; j < cells.length; j++) {
							
								
                                
								if ((j == 1 || j == 4 || j == 7 || j == 10) && i != 0 && lunchTrigger != 1) {
								
									cell.classList.add("period");
								}
							
							
							if (lunchTrigger == 0) {
								cell = row.insertCell(-1);
							} else if (lunchTrigger == 1) {
															//document.getElementById('periodsP').innerHTML = "inside cell creation";
															cell = row.insertCell(-1);
																if (cells[j] != "" && cells[j] != 0){
																	cell.classList.add('lunch');
																}
															}
															
								var cellDateRaw = new Date();
								var cellDate = new Date(cellDateRaw.toLocaleDateString() + " " + cells[j]);
						
								
///////////////////////////////////////////////////////////////////////////////FIGURE OUT HOW TO IMPORT LUNCHES/////////////////////								
								if (cells[j] == "Lunches") {
									lunchTrigger = 1;
								}
								if (lunchTrigger == 1) {
									//document.getElementById('periodsP').innerHTML = rows.length;
									
								}
								/*	//i = rows.length;
									//j = cells.length;
									//break;
								}*/
							if (lunchTrigger == 0){
								if ( i == 0 || j == 0 || j == 3 || j == 6 || j == 9 || cells[j] == ""){
									cell.innerHTML = cells[j];}
									else {
                                //cell.innerHTML = cellDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' , hour12: true });
										cell.innerHTML = cellDate.toLocaleTimeString('en-US-u-hc-h12', { hour: 'numeric', minute: '2-digit' });
									}
							} else if (lunchTrigger == 1) {
								//document.getElementById('periodsP').innerHTML = "inside row assignment";
															if ( i == 0 || j == 0 || j == 3 || j == 6 || j == 9 || cells[j] == 0){
																												cell.innerHTML = cells[j];
																}
																else {
																	//document.getElementById('periodsP').innerHTML = j;
																	//cell.innerHTML = cellDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' , hour12: true });
																	cell.innerHTML = cellDate.toLocaleTimeString('en-US-u-hc-h12', { hour: 'numeric', minute: '2-digit' });
																}
														}
							switch(i){
								case 0:
									cell.classList.add("header");
									break;
								case 1:
									cell.classList.add("row1");
									break;
								case 2:
									cell.classList.add("row2");
									break;
								case 3:
									cell.classList.add("row3");
									break;
								case 4:
									cell.classList.add("row4");
									break;
								case 5:
									cell.classList.add("row5");
									break;
								case 6:
									cell.classList.add("row6");
									break;
								case 7:
									cell.classList.add("row7");
									break;
								case 8:
									cell.classList.add("row8");
									break;
								case 9:
									cell.classList.add("row9");
									break;
								case 10:
									cell.classList.add("row10");
									break;
								case 11: cell.classList.add("row11");
									break;
							}
							switch(j){
								case 0:
									cell.classList.add("col1");
									break;
								case 1:
									cell.classList.add("col2");
									if ( i != 0){
										cell.classList.add("time");
										
									}
									break;
								case 2:
									cell.classList.add("col3");
									if ( i != 0){
										cell.classList.add("time");
									}
									break;
								case 3:
									cell.classList.add("col4");
									break;
								case 4:
									cell.classList.add("col5");
									if ( i != 0){
										cell.classList.add("time");
										
									}
									break;
								case 5:
									cell.classList.add("col6");
									if ( i != 0){
										cell.classList.add("time");
										
									}
									break;
								case 6:
									cell.classList.add("col7");
									break;
								case 7:
									cell.classList.add("col8");
									if ( i != 0){
										cell.classList.add("time");
										
									}
									break;
								case 8:
									cell.classList.add("col9");
									if ( i != 0){
										cell.classList.add("time");
									}
									break;
								case 9:
									cell.classList.add("col10");
									break;
								case 10:
										cell.classList.add("col11");
									if ( i != 0){
										cell.classList.add("time");
									}
									break;
								case 11:
										cell.classList.add("col12");
									if ( i != 0){
										cell.classList.add("time");
									}
									break;
									
							}
							
							if (lunchTrigger == 1) {
													cell.classList.remove('period');
													cell.classList.remove('time');
							}
								
                        }
						
                    }
					
					}
                    var dvCSV = document.getElementById("dvCSV");
                    dvCSV.innerHTML = "";
					var dvCSVLabel = document.getElementById('dvCSVLabel');
					dvCSVLabel.innerHTML = "<h3 id='dvCSVLabel'>Full Schedule</h3>";
					table.deleteRow(-1);
                    dvCSV.appendChild(table);
					var dvLunches = document.getElementById("dvLunches");
					dvLunches.innerHTML = "<h1 id='lunchesLabel'>Lunches</h1>";
					dvLunches.appendChild(tableLunches);
					var lunchTdCount = document.getElementsByClassName('lunch').length;
					var lunchTDs = document.getElementsByClassName('lunch');
					
					/*for (var z = 0; z < lunchTdCount; z++) {
						lunchTDs[z].setAttribute('width', '11.11%');
					}*/
					//document.getElementsByClassName('lunch').setAttribute('width', '33%');
					
						var marqueeDiv = document.getElementById("marquee");
						var headerRow = document.getElementsByClassName("header");
						//document.getElementById('periodsP').innerHTML = headerRow.length;
					if (headerRow.length > 9){
								marqueeDiv.innerHTML = "<table id='marqueeTable'><tr><td id='gradeAHeader' class='marqueeTD4'></td><td id='gradeBHeader' class='marqueeTD4'></td><td id='gradeCHeader' class='marqueeTD4'></td><td id='gradeDHeader' class='marqueeTD4'></td></tr><tr><td id='gradeAMarquee' class='marqueeTD4'></td><td id='gradeBMarquee' class='marqueeTD4'></td><td id='gradeCMarquee' class='marqueeTD4'></td><td id='gradeDMarquee' class='marqueeTD4'></td></tr></table>";
								document.getElementById('displayContainer').style.width = "95%";
								for (var z = 0; z < lunchTdCount; z++) {
									lunchTDs[z].setAttribute('width', '8.33%');
								}
					}
					else if (headerRow.length > 3) {
							marqueeDiv.innerHTML = "<table id='marqueeTable'><tr><td id='gradeAHeader' class='marqueeTD'></td><td id='gradeBHeader' class='marqueeTD'></td><td id='gradeCHeader' class='marqueeTD'></td></tr><tr><td id='gradeAMarquee' class='marqueeTD'></td><td id='gradeBMarquee' class='marqueeTD'></td><td id='gradeCMarquee' class='marqueeTD'></td></tr></table>";
							document.getElementById('displayContainer').style.width = "95%";
							for (var z = 0; z < lunchTdCount; z++) {
								lunchTDs[z].setAttribute('width', '11.11%');
							}
							//marqueeDiv.style.
					} else {
							marqueeDiv.innerHTML = "<table id='marqueeTable-single'><tr><td id='gradeAHeader' class='marqueeTD-single'></td></tr><tr><td id='gradeAMarquee' class='marqueeTD-single'></td></tr></table>";
							document.getElementById('displayContainer').style.width = "85%";
							for (var z = 0; z < lunchTdCount; z++) {
								lunchTDs[z].setAttribute('width', '33.33%');
							}		
					}
							
	
					if (document.getElementsByClassName('header col2')[0] && headerRow.length >3){
						document.getElementsByClassName('header col2')[0].innerHTML = document.getElementsByClassName('header col2')[0].innerHTML + "th Grade";
					} else if (document.getElementsByClassName('header col2')[0]) {
							document.getElementsByClassName('header col2')[0].innerHTML = document.getElementsByClassName('header col2')[0].innerHTML;
						}
					if (document.getElementsByClassName('header col5')[0]){
						document.getElementsByClassName('header col5')[0].innerHTML = document.getElementsByClassName('header col5')[0].innerHTML + "th Grade";
					}
					if (document.getElementsByClassName('header col8')[0]){
						document.getElementsByClassName('header col8')[0].innerHTML = document.getElementsByClassName('header col8')[0].innerHTML + "th Grade";
					}
					if (document.getElementsByClassName('header col11')[0]){
						document.getElementsByClassName('header col11')[0].innerHTML = document.getElementsByClassName('header col11')[0].innerHTML + "th Grade";
					}
                }
              //  reader.readAsText(fileUpload.files[0]);
       /*     } else {
                alert("This browser does not support HTML5.");
            } 
        } else {
            alert("Please upload a valid CSV file.");
        }
					
	}*/
	
	function uploadLunches() {
		//alert("Inside uploadLunches");
	}


</script>
	<div id="displayContainer">	
		<div id="marquee"></div>
		<div id="dvLunches"></div>
		<div id="dvCSVLabel"></div>
		<div id="dvCSV"></div>
	</div>
<div id="buttons">


<label for='schools' id='schoolsLabel'>Choose your school: </label>
<select name='schools' id='schools'>
	<option value='default'  disabled selected hidden>Select your school.</option>
	<option value='CHS'>CHS</option>
	<option value='KHS'>KHS</option>
	<option value='KiMS'>KiMS</option>
	<option value='KMS'>KMS</option>
	<option value='MCHS'>MCHS</option>
	<option value='MCMS'>MCMS</option>
	<option value='NEHS'>NEHS</option>
	<option value='NEMS'>NEMS</option>
	<option value='NPMS'>NPMS</option>
	<option value='NWHS'>NWHS</option>
	<option value='RMS'>RMS</option>
	<option value='RSHS'>RSHS</option>
	<option value='RSMS'>RSMS</option>
	<option value='WCHS'>WCHS</option>
	<option value='WCMS'>WCMS</option>
</select>
	<br />
	<label for='schedules' id='schedulesLabel'>Choose today's schedule: </label>
<select name='schedules' id='schedules'>
	<option value='default' disabled selected hidden>Select today's schedule.</option>
	<option value='normal'>Normal</option>
	<option value='half-day'>Half Day</option>
	<option value='1-hour-delay'>1 Hour Delay</option>
	<option value='2-hour-delay'>2 Hour Delay</option>
	<option value='am-pep-rally'>AM Pep Rally</option>
	<option value='pm-pep-rally'>PM Pep Rally</option>
	<option value='request-new-sched'>Request new/updated schedule</option>
	<option value='TCAP-4-17-23'>TCAP (4/17/23)</option>
	<option value='TCAP-4-18-23'>TCAP (4/18/23)</option>
	<option value='TCAP-4-20-23'>TCAP (4/20/23)</option>
	</select>
	<br />
	<p id='selectWarning'></p>
	<input type="button" id="upload" value="Load Schedule" onclick="Upload()" />

	
	<div id="links">
		<a href="/readme"><p class="linksContent">How to Use This Page</p></a>
	</div>
</div>	
	


</body>

<script>
	function preSelect(select, name) {

	let options = select.options, i=0;
    for (i = 0; i < options.length; i += 1) {
        if (options[i].value == name) {
            options[i].setAttribute('selected', 'selected');
        } else {
            options[i].removeAttribute('selected');
        }
    }
}

// the variable called "name" is the one that is retrieved from the querystring
	let curURL = window.location.href;
	let nameSchool = curURL.split("?")[1];
	let nameSched = curURL.split("?")[2];
	if (!nameSchool) {
		nameSchool = "default";
	}
	if (!nameSched) {
		nameSched = "default";
	}
	if (nameSchool != "default") {
		document.getElementById("schools").disabled = true;
	}
	if (nameSched != "default") {
		document.getElementById("schedules").disabled = true;
	}
let selectSchool = document.getElementById('schools');
let selectSched = document.getElementById('schedules');
preSelect(selectSchool, nameSchool);
preSelect(selectSched, nameSched);
	if (nameSchool != "default" && nameSched != "default") {
		document.getElementById("schools").disabled = true;
		document.getElementById("schedules").disabled = true;
		document.getElementById("upload").click();
	}
</script>
<style>
#ctContainer {
  background-position: left center;
  background-repeat: no-repeat;
	min-height: 75px;
  max-height: 150px;
  background-size: 150px;
}
#ct {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 75px;
  margin: 0px;
 }
#date {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  margin: -20px 0px 0px 0px;
  font-weight: bold;
 }
#bodyLabelContainer {
	display: flex;
  	justify-content: center;
  	align-items: center;
	margin: 0px;
	height: 75px;
	}
#displayContainer {
	margin-left: auto;
	margin-right: auto;
	}
.linksContent {
	display: inline;
	margin: 3%;
}
#links {
	text-align: center;
	margin-bottom: 1.5%;
}
#dvCSVLabel {
	text-align: center;
	margin-bottom: 0;
	margin-top: 10px;
}
#dvCSV {
	margin-bottom: 2%;
}
#dvLunches {
	text-align: center;
	margin-bottom: 2%;
}
#lunchesLabel {
	font-size: 2em;
	margin-bottom: 0;
	margin-top: 10px;
}
.lunch.col1 {
	
}
#marquee {
	text-align: center;
	}
#marqueeTable {
	margin-top: 1%;
	height: 10%;
	text-align: center;
	border: 4px solid black;
	border-collapse: collapse;
	font-size: 1.75em;
}
#marqueeTable td {
	border: 4px solid black;
	font-size: 1.15em;
}
#marqueeTable-single {
	margin-top: 1%;
	height: 10%;
	text-align: center;
	border: 4px solid black;
	border-collapse: collapse;
	font-size: 1.75em;
	}
#marqueeTable-single td {
	border: 4px solid black;
	font-size: 1.15em;
}
.marqueeTD {
	width: 33%;
}
.marqueeTD4 {
	width: 25%;
}
#gradeAHeader, #gradeBHeader, #gradeCHeader, #gradeDHeader{
	font-weight: bold;
}
#tableLunches td {
	border: 2px solid black;
	border-collapse: collapse;
	padding: 3px;
}
#tableLunches tr {
	border: 2px solid black;
	border-collapse: collapse;
	margin-bottom: 0;
}
#table td {
	border: 2px solid black;
	border-collapse: collapse;
	font-size: 1.15em;
}
#table tr {
	border: 2px solid black;
	border-collapse: collapse;
}
#table {
	padding-bottom: 10%;
}
table {
	width: 95%;
	margin-left: auto;
	margin-right: auto;
	border: 4px solid black;
	border-collapse: collapse;
}
h1 {
	text-align: center;
}
#buttons {
	position: absolute;
	width: 100%;
	margin: 1% 0 2% 0;
	text-align: center;
}
#fileUpload, #upload, #schools, #schoolsLabel, #selectWarning {
	margin-bottom: 1%;
	margin-top: 0;
}
#selectWarning {
	text-align: center;
	}
#schedules, #schedulesLabel {
	margin-bottom: 0;
	margin-top: 0;
}
body {
	position: relative;
}
.period {
	text-align: center;
	font-weight: bold;
}
.header {
	border-left: 0 !important;
	border-right: 0 !important;
	border-bottom: 4px solid black !important;
	text-align: center;
	font-weight: bold;
}
.col3, .col6, .col9 {
	border-right: 4px solid black !important;
}
</style>
